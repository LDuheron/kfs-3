# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile                                           :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: athierry <marvin@42.fr>                    +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2022/02/17 22:36:58 by athierry          #+#    #+#              #
#    Updated: 2025/06/30 17:58:56 by athierry         ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

# **************************************************************************** #
# ******************************* NAMES ************************************** #
# **************************************************************************** #

NAME = rbTree

# **************************************************************************** #
# ******************************* FLAGS ************************************** #
# **************************************************************************** #

CC = clang
CFLAGS = -fPIC
CPPFLAGS =

CHECKFLAGS = -fsanitize=address -Wall -Wextra -Werror
CPPCHECKFLAGS = -fsanitize=address -Wall -Wextra -Werror

DEBUGFLAGS = -g3 
PPDEBUGFLAGS = -g3

ifeq ($(MAKECMDGOALS),debug)
CFLAGS += $(DEBUGFLAGS)
CPPFLAGS += $(PPDEBUGFLAGS)
endif

ifeq ($(MAKECMDGOALS),check)
CFLAGS += $(CHECKFLAGS)
CPPFLAGS += $(CPPCHECKFLAGS)
endif

RM = rm -f

# **************************************************************************** #
# ******************************* INCLUDE************************************* #
# **************************************************************************** #

HEAD_PATH = include/
HEAD = $(HEAD_PATH)malloc.h

# **************************************************************************** #
# ******************************* SOURCES ************************************ #
# **************************************************************************** #

SRC_FILES = deletion.c \
	    insertion.c \
	    operations.c \
	    main.c \

SRCS_PATH = src/
SRCS_FILES = $(SRC_FILES)
SRCS = $(addprefix $(SRCS_PATH),$(SRCS_FILES))
		
# **************************************************************************** #
# ******************************* OBJECTS ************************************ #
# **************************************************************************** #

OBJS_PATH = obj/
OBJS_FILES = $(SRCS_FILES:.c=.o)
OBJS = $(addprefix $(OBJS_PATH),$(OBJS_FILES))

# **************************************************************************** #
# ******************************* DEPENDENCIES ******************************* #
# **************************************************************************** #

DEPS = $(OBJS:.o=.d)

# **************************************************************************** #
# ******************************* RULES ************************************** #
# **************************************************************************** #

.PHONY: all
all: $(NAME)

-include $(DEPS)


$(NAME): $(OBJS)
	$(CC) -o $@ $^

$(OBJS_PATH)%.o: $(SRCS_PATH)%.c
	@[ -d $(OBJS_PATH) ] || mkdir -p $(OBJS_PATH)
	$(CC) -I $(HEAD_PATH) -MMD $(CFLAGS) -o $@  -c $<

.PHONY: clean
clean:
	$(RM) $(OBJS) $(DEPS)

.PHONY: fclean
fclean: clean
	$(RM) $(NAME)

.PHONY: re
re: fclean all

.PHONY: dirty
dirty: re
	@$(RM) $(OBJS) $(DEPS)

.PHONY: debug
debug: dirty

.PHONY: check
check: dirty

.DEFAULT_GOAL := all

# **************************************************************************** #
